<Window x:Class="QualTrack.UI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="QualTrack - Navy Arms Qualification Manager" Height="600" Width="1000"
        Icon="/QualTrackIcon.ico">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <!-- Menu Bar -->
        <Menu Grid.Row="0">
            <MenuItem Header="File">
                <MenuItem x:Name="ImportRosterMenuItem" Header="Import Roster" Click="ImportRoster_Click"/>
                <MenuItem x:Name="ExportQualificationsMenuItem" Header="Export Qualifications" Click="ExportQualifications_Click"/>
                <MenuItem x:Name="LoadTestDataMenuItem" Header="Load Test Data" Click="LoadTestData_Click"/>
                <Separator/>
                <MenuItem Header="Exit" Click="Exit_Click"/>
            </MenuItem>
            <MenuItem Header="Personnel">
                <MenuItem x:Name="AddPersonnelMenuItem" Header="Add Personnel" Click="AddPersonnel_Click"/>
                <MenuItem Header="View All Personnel" Click="ViewPersonnel_Click"/>
            </MenuItem>
            <MenuItem Header="Qualifications">
                <MenuItem x:Name="AddQualificationMenuItem" Header="Add Qualification" Click="AddQualification_Click"/>
                <MenuItem Header="View All Qualifications" Click="ViewQualifications_Click"/>
            </MenuItem>
            <MenuItem x:Name="RoleMenu" Header="Role">
                <MenuItem x:Name="RoleAdminMenuItem" Header="Admin" Tag="Admin" Click="RoleMenuItem_Click" IsCheckable="True"/>
                <MenuItem x:Name="RoleSamiMenuItem" Header="SAMI" Tag="SAMI" Click="RoleMenuItem_Click" IsCheckable="True"/>
                <MenuItem x:Name="RoleCswiMenuItem" Header="CSWI" Tag="CSWI" Click="RoleMenuItem_Click" IsCheckable="True"/>
                <MenuItem x:Name="RoleMedicalMenuItem" Header="Medical" Tag="Medical" Click="RoleMenuItem_Click" IsCheckable="True"/>
                <MenuItem x:Name="RoleAAandEMenuItem" Header="AA&amp;E" Tag="AAandE" Click="RoleMenuItem_Click" IsCheckable="True"/>
                <MenuItem x:Name="RoleViewerMenuItem" Header="Viewer" Tag="Viewer" Click="RoleMenuItem_Click" IsCheckable="True"/>
            </MenuItem>
        </Menu>
        
        <!-- Main Content -->
        <TabControl x:Name="MainTabControl" Grid.Row="1" Margin="10" SelectionChanged="MainTabControl_SelectionChanged">
            <TabItem x:Name="DashboardTab" Header="Dashboard">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Filter Controls -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <Label Content="Filter by Status:" VerticalAlignment="Center"/>
                        <ComboBox x:Name="StatusFilterComboBox" Width="150" Margin="5,0" SelectionChanged="StatusFilter_SelectionChanged">
                            <ComboBoxItem Content="All"/>
                            <ComboBoxItem Content="Qualified"/>
                            <ComboBoxItem Content="Sustainment Due"/>
                            <ComboBoxItem Content="Lapsed"/>
                        </ComboBox>
                        <Label Content="Filter by Duty Section Type:" VerticalAlignment="Center" Margin="20,0,0,0"/>
                        <ComboBox x:Name="DutySectionTypeFilterComboBox" Width="100" Margin="5,0" SelectionChanged="DutySectionFilter_SelectionChanged">
                            <ComboBoxItem Content="All"/>
                            <ComboBoxItem Content="3 Section"/>
                            <ComboBoxItem Content="6 Section"/>
                        </ComboBox>
                        <Label Content="Section Number:" VerticalAlignment="Center" Margin="10,0,0,0"/>
                        <ComboBox x:Name="DutySectionNumberFilterComboBox" Width="80" Margin="5,0" SelectionChanged="DutySectionNumberFilterComboBox_SelectionChanged">
                            <ComboBoxItem Content="All"/>
                            <!-- Numbers will be populated dynamically -->
                        </ComboBox>
                        <Label Content="Filter by Weapon:" VerticalAlignment="Center" Margin="20,0,0,0"/>
                        <ComboBox x:Name="WeaponFilterComboBox" Width="100" Margin="5,0" SelectionChanged="WeaponFilter_SelectionChanged">
                            <ComboBoxItem Content="All"/>
                            <ComboBoxItem Content="M9"/>
                            <ComboBoxItem Content="M4/M16"/>
                            <ComboBoxItem Content="M500"/>
                            <ComboBoxItem Content="M240"/>
                            <ComboBoxItem Content=".50"/>
                        </ComboBox>
                    </StackPanel>
                    
                    <!-- Dashboard Controls and Color Legend -->
                    <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,10">
                        <Button x:Name="DashboardSetupButton" Content="Dashboard Setup" Click="DashboardSetup_Click" Margin="0,0,10,0" Padding="15,5"/>
                        <Button Content="Refresh" Click="Refresh_Click" Margin="0,0,20,0" Padding="15,5"/>
                        
                        <!-- Color Legend -->
                        <TextBlock Text="Weapon Qualification Colors: " FontWeight="Bold" VerticalAlignment="Center" Margin="20,0,0,0"/>
                        <Border Background="LightGreen" BorderBrush="Gray" BorderThickness="1" Margin="5,0" Padding="5,2">
                            <TextBlock Text="Green = Current" FontSize="10"/>
                        </Border>
                        <Border Background="Yellow" BorderBrush="Gray" BorderThickness="1" Margin="5,0" Padding="5,2">
                            <TextBlock Text="Yellow = Sustainment Due" FontSize="10"/>
                        </Border>
                        <Border Background="Orange" BorderBrush="Gray" BorderThickness="1" Margin="5,0" Padding="5,2">
                            <TextBlock Text="Orange = Expires in 30 days" FontSize="10"/>
                        </Border>
                        <Border Background="Transparent" BorderBrush="Gray" BorderThickness="1" Margin="5,0" Padding="5,2">
                            <TextBlock Text="No Color = Not Qualified" FontSize="10"/>
                        </Border>
                        <Border Background="Red" BorderBrush="Gray" BorderThickness="1" Margin="5,0" Padding="5,2">
                            <TextBlock Text="Red = Admin UNSAT" FontSize="10"/>
                        </Border>
                        <Border Background="LightGreen" BorderBrush="Gray" BorderThickness="1" Margin="5,0" Padding="5,2">
                            <StackPanel Orientation="Horizontal">
                                <Grid Width="14" Height="12" Margin="0,0,4,0">
                                    <TextBlock Text="X" Foreground="Red" FontWeight="Bold" FontSize="10" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Grid>
                                <TextBlock Text="Red X = Admin not current (gun-only)" FontSize="10"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                    
                    <!-- Personnel List -->
                    <DataGrid x:Name="PersonnelDataGrid" Grid.Row="2" 
                              AutoGenerateColumns="False" 
                              CanUserAddRows="False" 
                              CanUserDeleteRows="False"
                              IsReadOnly="True"
                              SelectionMode="Single"
                              GridLinesVisibility="Horizontal"
                              HeadersVisibility="Column"
                              EnableRowVirtualization="True"
                              EnableColumnVirtualization="True"
                              VirtualizingPanel.IsVirtualizing="True"
                              VirtualizingPanel.VirtualizationMode="Recycling"
                              VirtualizingPanel.ScrollUnit="Pixel"
                              VirtualizingPanel.CacheLength="5,5"
                              RowHeight="25"
                              AlternatingRowBackground="LightGray"
                              MouseDoubleClick="PersonnelDataGrid_MouseDoubleClick">
                        <!-- Columns will be added dynamically based on dashboard settings -->
                    </DataGrid>
                </Grid>
            </TabItem>
            
            <TabItem x:Name="AddAdminTab" Header="Electronic Admin">
                <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                    <Grid Margin="20">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="200"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="200"/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- Find Sailor Section -->
                        <GroupBox Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="4" Header="Find Existing Sailor" Margin="0,0,0,20">
                            <Grid Margin="10">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="200"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <Label Grid.Row="0" Grid.Column="0" Content="Search by Last Name:" VerticalAlignment="Center" Margin="0,5"/>
                                <TextBox x:Name="SearchLastNameTextBox" Grid.Row="0" Grid.Column="1" Margin="10,5" Width="180" KeyDown="SearchLastNameTextBox_KeyDown"/>
                                <Button Grid.Row="0" Grid.Column="2" Content="Search" Click="SearchSailor_Click" Margin="10,5" Padding="15,5"/>
                                <TextBlock Grid.Row="0" Grid.Column="3" x:Name="SearchResultTextBlock" Margin="10,5" VerticalAlignment="Center" Foreground="Gray"/>
                                
                                <Label Grid.Row="1" Grid.Column="0" Content="Select Match:" VerticalAlignment="Center" Margin="0,5"/>
                                <ComboBox x:Name="AdminSearchResultsComboBox" Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="3"
                                          Margin="10,5" DisplayMemberPath="DisplayName"
                                          SelectionChanged="AdminSearchResultsComboBox_SelectionChanged" Visibility="Collapsed"/>

                                <TextBlock Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="4" Text="Or fill out the form below to create a new sailor" 
                                           Margin="10,5,0,0" FontStyle="Italic" Foreground="Gray"/>
                            </Grid>
                        </GroupBox>
                        
                        <!-- Sailor Information -->
                        <GroupBox Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="4" Header="Sailor Information" Margin="0,0,0,20">
                            <Grid Margin="10">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="200"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="200"/>
                                </Grid.ColumnDefinitions>
                                
                                <Label Grid.Row="0" Grid.Column="0" Content="Last Name:" Margin="0,5"/>
                                <TextBox x:Name="AdminLastNameTextBox" Grid.Row="0" Grid.Column="1" Margin="10,5"/>
                                <Label Grid.Row="0" Grid.Column="2" Content="First Name:" Margin="0,5"/>
                                <TextBox x:Name="AdminFirstNameTextBox" Grid.Row="0" Grid.Column="3" Margin="10,5"/>
                                
                                <Label Grid.Row="1" Grid.Column="0" Content="DOD ID:" Margin="0,5"/>
                                <TextBox x:Name="AdminDODIdTextBox" Grid.Row="1" Grid.Column="1" Margin="10,5" PreviewTextInput="AdminDODIdTextBox_PreviewTextInput" ToolTip="Numbers only. Must be exactly 10 digits."/>
                                <Label Grid.Row="1" Grid.Column="2" Content="Rate:" Margin="0,5"/>
                                <ComboBox x:Name="AdminRateComboBox" Grid.Row="1" Grid.Column="3" Margin="10,5">
                                    <ComboBoxItem Content="ET"/>
                                    <ComboBoxItem Content="GM"/>
                                    <ComboBoxItem Content="BM"/>
                                    <ComboBoxItem Content="EM"/>
                                    <ComboBoxItem Content="MM"/>
                                    <ComboBoxItem Content="HT"/>
                                    <ComboBoxItem Content="DC"/>
                                    <ComboBoxItem Content="YN"/>
                                    <ComboBoxItem Content="PS"/>
                                    <ComboBoxItem Content="LS"/>
                                    <ComboBoxItem Content="CS"/>
                                    <ComboBoxItem Content="SH"/>
                                    <ComboBoxItem Content="SK"/>
                                    <ComboBoxItem Content="HM"/>
                                    <ComboBoxItem Content="MA"/>
                                    <ComboBoxItem Content="OS"/>
                                    <ComboBoxItem Content="QM"/>
                                    <ComboBoxItem Content="ST"/>
                                    <ComboBoxItem Content="AB"/>
                                    <ComboBoxItem Content="AM"/>
                                    <ComboBoxItem Content="AD"/>
                                    <ComboBoxItem Content="AE"/>
                                    <ComboBoxItem Content="AT"/>
                                    <ComboBoxItem Content="AZ"/>
                                    <ComboBoxItem Content="CT"/>
                                    <ComboBoxItem Content="ET"/>
                                    <ComboBoxItem Content="FC"/>
                                    <ComboBoxItem Content="FT"/>
                                    <ComboBoxItem Content="GM"/>
                                    <ComboBoxItem Content="GS"/>
                                    <ComboBoxItem Content="IC"/>
                                    <ComboBoxItem Content="IS"/>
                                    <ComboBoxItem Content="IT"/>
                                    <ComboBoxItem Content="MC"/>
                                    <ComboBoxItem Content="MN"/>
                                    <ComboBoxItem Content="MT"/>
                                    <ComboBoxItem Content="NC"/>
                                    <ComboBoxItem Content="ND"/>
                                    <ComboBoxItem Content="PR"/>
                                    <ComboBoxItem Content="QM"/>
                                    <ComboBoxItem Content="RP"/>
                                    <ComboBoxItem Content="RS"/>
                                    <ComboBoxItem Content="SB"/>
                                    <ComboBoxItem Content="SM"/>
                                    <ComboBoxItem Content="ST"/>
                                    <ComboBoxItem Content="SW"/>
                                    <ComboBoxItem Content="TM"/>
                                    <ComboBoxItem Content="UT"/>
                                    <ComboBoxItem Content="YN"/>
                                </ComboBox>
                                
                                <Label Grid.Row="2" Grid.Column="0" Content="Rank:" Margin="0,5"/>
                                <ComboBox x:Name="AdminRankComboBox" Grid.Row="2" Grid.Column="1" Margin="10,5">
                                    <ComboBoxItem Content="E-1"/>
                                    <ComboBoxItem Content="E-2"/>
                                    <ComboBoxItem Content="E-3"/>
                                    <ComboBoxItem Content="E-4"/>
                                    <ComboBoxItem Content="E-5"/>
                                    <ComboBoxItem Content="E-6"/>
                                    <ComboBoxItem Content="E-7"/>
                                    <ComboBoxItem Content="E-8"/>
                                    <ComboBoxItem Content="E-9"/>
                                    <ComboBoxItem Content="O-1"/>
                                    <ComboBoxItem Content="O-2"/>
                                    <ComboBoxItem Content="O-3"/>
                                    <ComboBoxItem Content="O-4"/>
                                    <ComboBoxItem Content="O-5"/>
                                    <ComboBoxItem Content="O-6"/>
                                    <ComboBoxItem Content="O-7"/>
                                    <ComboBoxItem Content="O-8"/>
                                    <ComboBoxItem Content="O-9"/>
                                    <ComboBoxItem Content="O-10"/>
                                </ComboBox>
                            </Grid>
                        </GroupBox>
                        
                        <!-- Form 2760 (Lautenberg Act) -->
                        <GroupBox Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="4" Header="Form 2760 (Lautenberg Act)" Margin="0,0,0,20">
                            <Grid Margin="10">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="200"/>
                                </Grid.ColumnDefinitions>
                                
                                <!-- Domestic Violence Question -->
                                <TextBlock Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="4" Text="Have you been convicted of a crime of domestic violence?" 
                                           FontWeight="Bold" Margin="0,5,0,10"/>
                                
                                <!-- Yes/No/Unknown Options -->
                                <StackPanel Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="3" Orientation="Horizontal" Margin="0,5">
                                    <CheckBox x:Name="DD2760YesCheckBox" Content="Yes (Initial)" Margin="0,0,10,0" Checked="DD2760Response_Changed" Unchecked="DD2760Response_Changed"/>
                                    <TextBox x:Name="DD2760YesInitialsTextBox" Width="80" Margin="0,0,20,0" IsEnabled="{Binding ElementName=DD2760YesCheckBox, Path=IsChecked}"/>
                                    <CheckBox x:Name="DD2760NoCheckBox" Content="No (Initial)" Margin="0,0,10,0" Checked="DD2760Response_Changed" Unchecked="DD2760Response_Changed"/>
                                    <TextBox x:Name="DD2760NoInitialsTextBox" Width="80" Margin="0,0,20,0" IsEnabled="{Binding ElementName=DD2760NoCheckBox, Path=IsChecked}"/>
                                    <CheckBox x:Name="DD2760UnknownCheckBox" Content="Unknown (Initial)" Margin="0,0,10,0" Checked="DD2760Response_Changed" Unchecked="DD2760Response_Changed"/>
                                    <TextBox x:Name="DD2760UnknownInitialsTextBox" Width="80" Margin="0,0,20,0" IsEnabled="{Binding ElementName=DD2760UnknownCheckBox, Path=IsChecked}"/>
                                </StackPanel>
                                
                                <DatePicker x:Name="DD2760DomesticViolenceDatePicker" Grid.Row="1" Grid.Column="3" Margin="10,5,0,5"/>
                                
                                <!-- If Yes Section -->
                                <TextBlock Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="4" Text="If yes:" FontWeight="Bold" Margin="0,15,0,10"/>
                                
                                <Label Grid.Row="3" Grid.Column="0" Content="Court/Jurisdiction:" Margin="0,5"/>
                                <TextBox x:Name="DD2760CourtJurisdictionTextBox" Grid.Row="3" Grid.Column="1" Margin="10,5"/>
                                
                                <Label Grid.Row="3" Grid.Column="2" Content="Docket/Case Number:" Margin="10,5,5,5"/>
                                <TextBox x:Name="DD2760DocketCaseNumberTextBox" Grid.Row="3" Grid.Column="3" Margin="5,5,0,5"/>
                                
                                <Label Grid.Row="4" Grid.Column="0" Content="Statute/Charge:" Margin="0,5"/>
                                <TextBox x:Name="DD2760StatuteChargeTextBox" Grid.Row="4" Grid.Column="1" Margin="10,5"/>
                                
                                <Label Grid.Row="4" Grid.Column="2" Content="Date Sentenced:" Margin="10,5,5,5"/>
                                <DatePicker x:Name="DD2760DateSentencedPicker" Grid.Row="4" Grid.Column="3" Margin="5,5,0,5"/>
                                
                                <!-- Certification Section -->
                                <StackPanel Grid.Row="5" Grid.Column="0" Grid.ColumnSpan="4" Orientation="Horizontal" Margin="0,15,0,5">
                                    <CheckBox x:Name="DD2760CertificationCheckBox" Margin="0,0,10,0"/>
                                    <TextBlock Text="I hereby certify that, to the best of my information and belief, all the information I have provided is true..." 
                                               TextWrapping="Wrap" VerticalAlignment="Center" Foreground="Gray" FontStyle="Italic"/>
                                </StackPanel>
                                
                                <Label Grid.Row="6" Grid.Column="0" Content="SSN:" Margin="0,5"/>
                                <TextBox x:Name="DD2760SSNTextBox" Grid.Row="6" Grid.Column="1" Width="150" Margin="10,5"/>
                                
                                <Label Grid.Row="6" Grid.Column="2" Content="Date Signed:" Margin="10,5,5,5"/>
                                <DatePicker x:Name="DD2760DateSignedPicker" Grid.Row="6" Grid.Column="3" Margin="5,5,0,5"/>
                                
                                <TextBlock Grid.Row="7" Grid.Column="0" Grid.ColumnSpan="4" Text="Annual requirement - expires 1 year from completion date" 
                                           Margin="0,10,0,5" Foreground="Gray" FontStyle="Italic"/>
                                
                                <!-- Submit Buttons -->
                                <StackPanel Grid.Row="8" Grid.Column="0" Grid.ColumnSpan="4" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
                                    <Button Content="Submit Medical Signature" 
                                            Click="Submit2760WatchstanderButton_Click" Margin="0,0,10,0" Padding="20,5"/>
                                    <Button Content="Submit AA&amp;E Officer Signature" 
                                            Click="Submit2760ApprovalButton_Click" Padding="20,5"/>
                                </StackPanel>
                            </Grid>
                        </GroupBox>
                        
                        <TextBlock Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="4" Text="Medical Signature Accepted" Foreground="Green" Margin="0,0,0,10"/>
                        
                        <!-- AA&E Screening -->
                        <GroupBox Grid.Row="4" Grid.Column="0" Grid.ColumnSpan="4" Header="AA&amp;E Screening" Margin="0,0,0,20">
                            <Grid Margin="10">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <!-- Person Being Screened (auto-populated from search) -->
                                <TextBlock Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="4" Text="Person Being Screened: (Auto-populated from search above)" 
                                           FontWeight="Bold" Margin="0,5,0,10" Foreground="Gray" FontStyle="Italic"/>
                                
                                <!-- Screener/Qualifier -->
                                <TextBlock Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="4" Text="Screener/Qualifier:" 
                                           FontWeight="Bold" Margin="0,5,0,10"/>
                                
                                <Label Grid.Row="2" Grid.Column="0" Content="Name:" Margin="0,5"/>
                                <TextBox x:Name="AAENameScreenerTextBox" Grid.Row="2" Grid.Column="1" Margin="10,5"/>
                                
                                <Label Grid.Row="2" Grid.Column="2" Content="Rank:" Margin="10,5,5,5"/>
                                <TextBox x:Name="AAERankScreenerTextBox" Grid.Row="2" Grid.Column="3" Margin="5,5,0,5"/>
                                
                                <Label Grid.Row="3" Grid.Column="0" Content="DOD ID:" Margin="0,5"/>
                                <TextBox x:Name="AAEDODIDScreenerTextBox" Grid.Row="3" Grid.Column="1" Margin="10,5"/>
                                
                                <!-- Questions Header -->
                                <TextBlock Grid.Row="4" Grid.Column="0" Grid.ColumnSpan="4" Text="Screening Questions:" 
                                           FontWeight="Bold" Margin="0,15,0,10"/>
                                
                                <!-- Questions Table Header -->
                                <Grid Grid.Row="5" Grid.Column="0" Grid.ColumnSpan="4" Margin="0,0,0,5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="3*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="2*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="SUBJECT" FontWeight="Bold" Margin="0,5"/>
                                    <TextBlock Grid.Column="1" Text="YES" FontWeight="Bold" HorizontalAlignment="Center" Margin="10,5"/>
                                    <TextBlock Grid.Column="2" Text="NO" FontWeight="Bold" HorizontalAlignment="Center" Margin="10,5"/>
                                    <TextBlock Grid.Column="3" Text="N/A" FontWeight="Bold" HorizontalAlignment="Center" Margin="10,5"/>
                                    <TextBlock Grid.Column="4" Text="REMARKS" FontWeight="Bold" Margin="10,5"/>
                                </Grid>
                                
                                <!-- Question 1 -->
                                <Grid Grid.Row="6" Grid.Column="0" Grid.ColumnSpan="4" Margin="0,5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="3*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="2*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Margin="0,5" TextWrapping="Wrap">
                                        <Run Text="1. Has the individual qualified with the required"/>
                                        <LineBreak/>
                                        <Run Text="security weapon in the last 12 months?"/>
                                    </TextBlock>
                                    <CheckBox x:Name="AAEQuestion1YCheckBox" Grid.Column="1" Margin="10,5" HorizontalAlignment="Center" Checked="AAEQuestion1_Changed" Unchecked="AAEQuestion1_Changed"/>
                                    <CheckBox x:Name="AAEQuestion1NCheckBox" Grid.Column="2" Margin="10,5" HorizontalAlignment="Center" Checked="AAEQuestion1_Changed" Unchecked="AAEQuestion1_Changed"/>
                                    <CheckBox x:Name="AAEQuestion1NACheckBox" Grid.Column="3" Margin="10,5" HorizontalAlignment="Center" Checked="AAEQuestion1_Changed" Unchecked="AAEQuestion1_Changed"/>
                                    <TextBox x:Name="AAERemarks1TextBox" Grid.Column="4" Margin="10,5" TextWrapping="Wrap" AcceptsReturn="True" MinHeight="40" VerticalAlignment="Top"/>
                                </Grid>
                                
                                <!-- Question 2 -->
                                <Grid Grid.Row="7" Grid.Column="0" Grid.ColumnSpan="4" Margin="0,5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="3*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="2*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Margin="0,5" TextWrapping="Wrap">
                                        <Run Text="2. Individual's medical record has been screened by a"/>
                                        <LineBreak/>
                                        <Run Text="competent medical authority. There are no medical"/>
                                        <LineBreak/>
                                        <Run Text="conditions that would prevent the individual from duties"/>
                                        <LineBreak/>
                                        <Run Text="involving control of or unescorted access to AA&amp;E"/>
                                    </TextBlock>
                                    <CheckBox x:Name="AAEQuestion2YCheckBox" Grid.Column="1" Margin="10,5" HorizontalAlignment="Center" Checked="AAEQuestion2_Changed" Unchecked="AAEQuestion2_Changed"/>
                                    <CheckBox x:Name="AAEQuestion2NCheckBox" Grid.Column="2" Margin="10,5" HorizontalAlignment="Center" Checked="AAEQuestion2_Changed" Unchecked="AAEQuestion2_Changed"/>
                                    <CheckBox x:Name="AAEQuestion2NACheckBox" Grid.Column="3" Margin="10,5" HorizontalAlignment="Center" Checked="AAEQuestion2_Changed" Unchecked="AAEQuestion2_Changed"/>
                                    <TextBox x:Name="AAERemarks2TextBox" Grid.Column="4" Margin="10,5" TextWrapping="Wrap" AcceptsReturn="True" MinHeight="40" VerticalAlignment="Top"/>
                                </Grid>
                                
                                <!-- Question 3 -->
                                <Grid Grid.Row="8" Grid.Column="0" Grid.ColumnSpan="4" Margin="0,5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="3*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="2*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Margin="0,5" TextWrapping="Wrap">
                                        <Run Text="3. Has the individual had National Agency Check with"/>
                                        <LineBreak/>
                                        <Run Text="Local Agency and Credit Checks (NACLC) or Access National"/>
                                        <LineBreak/>
                                        <Run Text="Agency Check with Written Inquiries (ANACI) completed?"/>
                                    </TextBlock>
                                    <CheckBox x:Name="AAEQuestion3YCheckBox" Grid.Column="1" Margin="10,5" HorizontalAlignment="Center" Checked="AAEQuestion3_Changed" Unchecked="AAEQuestion3_Changed"/>
                                    <CheckBox x:Name="AAEQuestion3NCheckBox" Grid.Column="2" Margin="10,5" HorizontalAlignment="Center" Checked="AAEQuestion3_Changed" Unchecked="AAEQuestion3_Changed"/>
                                    <CheckBox x:Name="AAEQuestion3NACheckBox" Grid.Column="3" Margin="10,5" HorizontalAlignment="Center" Checked="AAEQuestion3_Changed" Unchecked="AAEQuestion3_Changed"/>
                                    <TextBox x:Name="AAERemarks3TextBox" Grid.Column="4" Margin="10,5" TextWrapping="Wrap" AcceptsReturn="True" MinHeight="40" VerticalAlignment="Top"/>
                                </Grid>
                                
                                <!-- Question 4 -->
                                <Grid Grid.Row="9" Grid.Column="0" Grid.ColumnSpan="4" Margin="0,5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="3*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="2*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Margin="0,5" TextWrapping="Wrap">
                                        <Run Text="4. Has the individual completed instruction in the use of"/>
                                        <LineBreak/>
                                        <Run Text="force in the last 12 months and signed a use of force"/>
                                        <LineBreak/>
                                        <Run Text="certification if required to be armed in the performance"/>
                                        <LineBreak/>
                                        <Run Text="of higher duties?"/>
                                    </TextBlock>
                                    <CheckBox x:Name="AAEQuestion4YCheckBox" Grid.Column="1" Margin="10,5" HorizontalAlignment="Center" Checked="AAEQuestion4_Changed" Unchecked="AAEQuestion4_Changed"/>
                                    <CheckBox x:Name="AAEQuestion4NCheckBox" Grid.Column="2" Margin="10,5" HorizontalAlignment="Center" Checked="AAEQuestion4_Changed" Unchecked="AAEQuestion4_Changed"/>
                                    <CheckBox x:Name="AAEQuestion4NACheckBox" Grid.Column="3" Margin="10,5" HorizontalAlignment="Center" Checked="AAEQuestion4_Changed" Unchecked="AAEQuestion4_Changed"/>
                                    <TextBox x:Name="AAERemarks4TextBox" Grid.Column="4" Margin="10,5" TextWrapping="Wrap" AcceptsReturn="True" MinHeight="40" VerticalAlignment="Top"/>
                                </Grid>
                                
                                <!-- Question 5 -->
                                <Grid Grid.Row="10" Grid.Column="0" Grid.ColumnSpan="4" Margin="0,5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="3*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="2*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Margin="0,5" TextWrapping="Wrap">
                                        <Run Text="5. Was any derogatory information noted in the personnel"/>
                                        <LineBreak/>
                                        <Run Text="record that would prohibit this individual from being"/>
                                        <LineBreak/>
                                        <Run Text="assigned duties involving control of or unescorted access"/>
                                        <LineBreak/>
                                        <Run Text="to AA&amp;E?"/>
                                    </TextBlock>
                                    <CheckBox x:Name="AAEQuestion5YCheckBox" Grid.Column="1" Margin="10,5" HorizontalAlignment="Center" Checked="AAEQuestion5_Changed" Unchecked="AAEQuestion5_Changed"/>
                                    <CheckBox x:Name="AAEQuestion5NCheckBox" Grid.Column="2" Margin="10,5" HorizontalAlignment="Center" Checked="AAEQuestion5_Changed" Unchecked="AAEQuestion5_Changed"/>
                                    <CheckBox x:Name="AAEQuestion5NACheckBox" Grid.Column="3" Margin="10,5" HorizontalAlignment="Center" Checked="AAEQuestion5_Changed" Unchecked="AAEQuestion5_Changed"/>
                                    <TextBox x:Name="AAERemarks5TextBox" Grid.Column="4" Margin="10,5" TextWrapping="Wrap" AcceptsReturn="True" MinHeight="40" VerticalAlignment="Top"/>
                                </Grid>
                                
                                <!-- Question 6 -->
                                <Grid Grid.Row="11" Grid.Column="0" Grid.ColumnSpan="4" Margin="0,5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="3*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="2*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Margin="0,5" TextWrapping="Wrap">
                                        <Run Text="6. Individual has no pending legal action and/or"/>
                                        <LineBreak/>
                                        <Run Text="convictions by court-martial, civilian courts, or"/>
                                        <LineBreak/>
                                        <Run Text="non-judicial punishment that would prohibit this individual"/>
                                        <LineBreak/>
                                        <Run Text="from being assigned duties involving control of or"/>
                                        <LineBreak/>
                                        <Run Text="unescorted access to AA&amp;E."/>
                                    </TextBlock>
                                    <CheckBox x:Name="AAEQuestion6YCheckBox" Grid.Column="1" Margin="10,5" HorizontalAlignment="Center" Checked="AAEQuestion6_Changed" Unchecked="AAEQuestion6_Changed"/>
                                    <CheckBox x:Name="AAEQuestion6NCheckBox" Grid.Column="2" Margin="10,5" HorizontalAlignment="Center" Checked="AAEQuestion6_Changed" Unchecked="AAEQuestion6_Changed"/>
                                    <CheckBox x:Name="AAEQuestion6NACheckBox" Grid.Column="3" Margin="10,5" HorizontalAlignment="Center" Checked="AAEQuestion6_Changed" Unchecked="AAEQuestion6_Changed"/>
                                    <TextBox x:Name="AAERemarks6TextBox" Grid.Column="4" Margin="10,5" TextWrapping="Wrap" AcceptsReturn="True" MinHeight="40" VerticalAlignment="Top"/>
                                </Grid>
                                
                                <!-- Question 7 -->
                                <Grid Grid.Row="12" Grid.Column="0" Grid.ColumnSpan="4" Margin="0,5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="3*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="2*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Margin="0,5" TextWrapping="Wrap">
                                        <Run Text="7. Is the individual mature, stable, and does he/she"/>
                                        <LineBreak/>
                                        <Run Text="show willingness and capability to be assigned to duties"/>
                                        <LineBreak/>
                                        <Run Text="involving control of or unescorted access to AA&amp;E?"/>
                                    </TextBlock>
                                    <CheckBox x:Name="AAEQuestion7YCheckBox" Grid.Column="1" Margin="10,5" HorizontalAlignment="Center" Checked="AAEQuestion7_Changed" Unchecked="AAEQuestion7_Changed"/>
                                    <CheckBox x:Name="AAEQuestion7NCheckBox" Grid.Column="2" Margin="10,5" HorizontalAlignment="Center" Checked="AAEQuestion7_Changed" Unchecked="AAEQuestion7_Changed"/>
                                    <CheckBox x:Name="AAEQuestion7NACheckBox" Grid.Column="3" Margin="10,5" HorizontalAlignment="Center" Checked="AAEQuestion7_Changed" Unchecked="AAEQuestion7_Changed"/>
                                    <TextBox x:Name="AAERemarks7TextBox" Grid.Column="4" Margin="10,5" TextWrapping="Wrap" AcceptsReturn="True" MinHeight="40" VerticalAlignment="Top"/>
                                </Grid>
                                
                                <!-- Signatures and Dates -->
                                <TextBlock Grid.Row="13" Grid.Column="0" Grid.ColumnSpan="4" Text="Signatures:" 
                                           FontWeight="Bold" Margin="0,15,0,10"/>
                                
                                <Grid Grid.Row="14" Grid.Column="0" Grid.ColumnSpan="4" Margin="0,5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Label Grid.Column="0" Content="Screened Signature:" Margin="0,5"/>
                                    <TextBox x:Name="AAESignatureScreenedTextBox" Grid.Column="1" Margin="10,5"/>
                                    <Label Grid.Column="2" Content="Date:" Margin="10,5,5,5"/>
                                    <DatePicker x:Name="AAEDateScreenedPicker" Grid.Column="3" Margin="5,5,0,5"/>
                                </Grid>
                                
                                <Grid Grid.Row="15" Grid.Column="0" Grid.ColumnSpan="4" Margin="0,5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Label Grid.Column="0" Content="Screener Signature:" Margin="0,5"/>
                                    <TextBox x:Name="AAESignatureScreenerTextBox" Grid.Column="1" Margin="10,5"/>
                                    <Label Grid.Column="2" Content="Date:" Margin="10,5,5,5"/>
                                    <DatePicker x:Name="AAEDateScreenerPicker" Grid.Column="3" Margin="5,5,0,5"/>
                                </Grid>
                                
                                <!-- Outcome -->
                                <TextBlock Grid.Row="16" Grid.Column="0" Grid.ColumnSpan="4" Text="Outcome:" 
                                           FontWeight="Bold" Margin="0,15,0,10"/>
                                
                                <StackPanel Grid.Row="17" Grid.Column="0" Grid.ColumnSpan="4" Orientation="Horizontal" Margin="0,5">
                                    <CheckBox x:Name="AAEQualifiedCheckBox" Content="Qualified" Margin="0,0,20,0" Checked="AAEOutcome_Changed" Unchecked="AAEOutcome_Changed"/>
                                    <CheckBox x:Name="AAEUnqualifiedCheckBox" Content="Unqualified" Margin="0,0,20,0" Checked="AAEOutcome_Changed" Unchecked="AAEOutcome_Changed"/>
                                    <CheckBox x:Name="AAEReviewLaterCheckBox" Content="Review Later" Margin="0,0,20,0" Checked="AAEOutcome_Changed" Unchecked="AAEOutcome_Changed"/>
                                    <Label Content="Other:" Margin="0,0,5,0"/>
                                    <TextBox x:Name="AAEOtherQualifiedTextBox" Width="200" Margin="0,0,0,0"/>
                                </StackPanel>
                                
                                <TextBlock Grid.Row="18" Grid.Column="0" Grid.ColumnSpan="4" Text="Annual requirement - expires 1 year from completion date" 
                                           Margin="0,10,0,5" Foreground="Gray" FontStyle="Italic"/>
                                
                                <!-- Submit Button -->
                                <Button Grid.Row="19" Grid.Column="0" Grid.ColumnSpan="4" Content="Submit AA&amp;E Screening" 
                                        Click="SubmitAAEScreeningButton_Click" HorizontalAlignment="Right" Margin="0,10,0,0" Padding="20,5"/>
                            </Grid>
                        </GroupBox>
                                
                                <!-- Deadly Force Training -->
                        <GroupBox Grid.Row="5" Grid.Column="0" Grid.ColumnSpan="4" Header="Deadly Force Training" Margin="0,0,0,20">
                            <Grid Margin="10">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="200"/>
                                </Grid.ColumnDefinitions>
                                
                                <DatePicker x:Name="DeadlyForceDatePicker" Grid.Row="0" Grid.Column="0" Margin="0,5"/>
                                <TextBlock Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="3" Text="Quarterly requirement - expires 3 months from completion date" 
                                           Margin="10,5" VerticalAlignment="Center" Foreground="Gray" FontStyle="Italic"/>

                                <Label Grid.Row="1" Grid.Column="0" Content="Signature (Trainee):" Margin="0,5"/>
                                <TextBox x:Name="DeadlyForceTraineeSignatureTextBox" Grid.Row="1" Grid.Column="1" Margin="10,5"/>
                                <Label Grid.Row="1" Grid.Column="2" Content="Date (Trainee):" Margin="10,5,5,5"/>
                                <DatePicker x:Name="DeadlyForceTraineeDatePicker" Grid.Row="1" Grid.Column="3" Margin="5,5,0,5"/>

                                <Label Grid.Row="2" Grid.Column="0" Content="Signature (Observer):" Margin="0,5"/>
                                <TextBox x:Name="DeadlyForceObserverSignatureTextBox" Grid.Row="2" Grid.Column="1" Margin="10,5"/>
                                <Label Grid.Row="2" Grid.Column="2" Content="Date (Observer):" Margin="10,5,5,5"/>
                                <DatePicker x:Name="DeadlyForceObserverDatePicker" Grid.Row="2" Grid.Column="3" Margin="5,5,0,5"/>
                                
                                <!-- Submit Button -->
                                <Button Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="4" Content="Submit Deadly Force Training" 
                                        Click="SubmitDeadlyForceTrainingButton_Click" HorizontalAlignment="Right" Margin="0,10,0,0" Padding="20,5"/>
                            </Grid>
                        </GroupBox>
                        
                        <!-- Status Text -->
                        <TextBlock x:Name="AdminStatusTextBlock" Grid.Row="5" Grid.Column="0" Grid.ColumnSpan="4" Margin="10" Foreground="Red"/>
                    </Grid>
                </ScrollViewer>
            </TabItem>
            
            <TabItem x:Name="SignatureInboxTab" Header="Signature Inbox">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="20">
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                            <Label Content="Status:" VerticalAlignment="Center"/>
                            <ComboBox x:Name="SignatureInboxStatusComboBox" Width="140" Margin="5,0,15,0"
                                      SelectionChanged="SignatureInboxFilter_Changed"/>
                            <Label Content="Form:" VerticalAlignment="Center"/>
                            <ComboBox x:Name="SignatureInboxFormComboBox" Width="160" Margin="5,0,15,0"
                                      SelectionChanged="SignatureInboxFilter_Changed"/>
                            <Button Content="Refresh" Click="SignatureInboxRefresh_Click" Padding="10,3"/>
                        </StackPanel>
                        <DataGrid x:Name="SignatureInboxGrid"
                                  AutoGenerateColumns="False"
                                  CanUserAddRows="False"
                                  CanUserDeleteRows="False"
                                  IsReadOnly="True"
                                  HeadersVisibility="Column"
                                  GridLinesVisibility="Horizontal"
                                  RowHeight="26">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Form" Binding="{Binding FormTypeDisplay}" Width="160"/>
                                <DataGridTextColumn Header="Personnel" Binding="{Binding PersonnelDisplay}" Width="200"/>
                                <DataGridTextColumn Header="Current Role" Binding="{Binding CurrentRole}" Width="140"/>
                                <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                                <DataGridTextColumn Header="Created" Binding="{Binding CreatedAtDisplay}" Width="140"/>
                                <DataGridTemplateColumn Header="Actions" Width="220">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Button Content="Open" Padding="6,2" Margin="0,0,5,0"
                                                        Click="SignatureInboxOpenPdf_Click"
                                                        CommandParameter="{Binding}"/>
                                                <Button Content="Sign" Padding="6,2" Margin="0,0,5,0"
                                                        Click="SignatureInboxSign_Click"
                                                        CommandParameter="{Binding}"/>
                                                <Button Content="Return" Padding="6,2"
                                                        Click="SignatureInboxReturn_Click"
                                                        CommandParameter="{Binding}"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                        <TextBlock x:Name="SignatureInboxStatusTextBlock" Foreground="Gray" Margin="0,10,0,0"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            
            <TabItem x:Name="SamiCswiManagementTab" Header="SAMI / CSWI Management">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="20">
                        <TextBlock Text="SAMI / CSWI Management" FontSize="18" FontWeight="Bold" Margin="0,0,0,10"/>
                        
                        <GroupBox Header="SAMI / CSWI Dashboard" Margin="0,0,0,20">
                            <Grid Margin="10">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                                    <Button Content="Refresh" Click="SamiCswiDashboardRefresh_Click" Margin="0,0,10,0" Padding="15,5"/>
                                </StackPanel>
                                
                                <DataGrid x:Name="SamiCswiDashboardGrid" Grid.Row="1"
                                          AutoGenerateColumns="False"
                                          CanUserAddRows="False"
                                          CanUserDeleteRows="False"
                                          IsReadOnly="True"
                                          SelectionMode="Single"
                                          GridLinesVisibility="Horizontal"
                                          HeadersVisibility="Column"
                                          EnableRowVirtualization="True"
                                          EnableColumnVirtualization="True"
                                          VirtualizingPanel.IsVirtualizing="True"
                                          VirtualizingPanel.VirtualizationMode="Recycling"
                                          VirtualizingPanel.ScrollUnit="Pixel"
                                          VirtualizingPanel.CacheLength="5,5"
                                          RowHeight="25"
                                          AlternatingRowBackground="LightGray"
                                          MouseDoubleClick="SamiCswiDashboardGrid_MouseDoubleClick">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="Auto"/>
                                        <DataGridTextColumn Header="Rate" Binding="{Binding Rate}" Width="Auto"/>
                                        <DataGridTextColumn Header="SAMI" Binding="{Binding Sami}" Width="Auto">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="HorizontalAlignment" Value="Center"/>
                                                    <Setter Property="Foreground" Value="Black"/>
                                                    <Setter Property="FontWeight" Value="Bold"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                            <DataGridTextColumn.CellStyle>
                                                <Style TargetType="DataGridCell">
                                                    <Setter Property="Background" Value="Transparent"/>
                                                    <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Sami}" Value="X">
                                                            <Setter Property="Background" Value="LightGreen"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="CSWI" Binding="{Binding Cswi}" Width="Auto">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="HorizontalAlignment" Value="Center"/>
                                                    <Setter Property="Foreground" Value="Black"/>
                                                    <Setter Property="FontWeight" Value="Bold"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                            <DataGridTextColumn.CellStyle>
                                                <Style TargetType="DataGridCell">
                                                    <Setter Property="Background" Value="Transparent"/>
                                                    <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Cswi}" Value="X">
                                                            <Setter Property="Background" Value="LightGreen"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>
                                        <DataGridTemplateColumn Header="Designation Letter" Width="Auto">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Border Background="{Binding DesignationColor}" BorderBrush="Gray" BorderThickness="1" Margin="1">
                                                        <TextBlock Text="{Binding DesignationStatus}" HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="Bold" Foreground="Black"/>
                                                    </Border>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Header="Current M9" Width="Auto">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Grid>
                                                        <Border Background="{Binding M9Color}" BorderBrush="Gray" BorderThickness="1" Margin="1">
                                                            <TextBlock Text="{Binding M9Qualified}" HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="Bold" Foreground="Black"/>
                                                        </Border>
                                                        <TextBlock Text="X" Foreground="Black" FontWeight="Bold" FontSize="14" HorizontalAlignment="Center" VerticalAlignment="Center">
                                                            <TextBlock.Style>
                                                                <Style TargetType="TextBlock">
                                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding M9AdminBlocked}" Value="True">
                                                                            <Setter Property="Visibility" Value="Visible"/>
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </TextBlock.Style>
                                                        </TextBlock>
                                                    </Grid>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Header="Current M4/M16" Width="Auto">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Grid>
                                                        <Border Background="{Binding M4M16Color}" BorderBrush="Gray" BorderThickness="1" Margin="1">
                                                            <TextBlock Text="{Binding M4M16Qualified}" HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="Bold" Foreground="Black"/>
                                                        </Border>
                                                        <TextBlock Text="X" Foreground="Black" FontWeight="Bold" FontSize="14" HorizontalAlignment="Center" VerticalAlignment="Center">
                                                            <TextBlock.Style>
                                                                <Style TargetType="TextBlock">
                                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding M4M16AdminBlocked}" Value="True">
                                                                            <Setter Property="Visibility" Value="Visible"/>
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </TextBlock.Style>
                                                        </TextBlock>
                                                    </Grid>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Header="Current M500" Width="Auto">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Grid>
                                                        <Border Background="{Binding M500Color}" BorderBrush="Gray" BorderThickness="1" Margin="1">
                                                            <TextBlock Text="{Binding M500Qualified}" HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="Bold" Foreground="Black"/>
                                                        </Border>
                                                        <TextBlock Text="X" Foreground="Black" FontWeight="Bold" FontSize="14" HorizontalAlignment="Center" VerticalAlignment="Center">
                                                            <TextBlock.Style>
                                                                <Style TargetType="TextBlock">
                                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding M500AdminBlocked}" Value="True">
                                                                            <Setter Property="Visibility" Value="Visible"/>
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </TextBlock.Style>
                                                        </TextBlock>
                                                    </Grid>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Header="Current M240" Width="Auto">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Grid>
                                                        <Border Background="{Binding M240Color}" BorderBrush="Gray" BorderThickness="1" Margin="1">
                                                            <TextBlock Text="{Binding M240Qualified}" HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="Bold" Foreground="Black"/>
                                                        </Border>
                                                        <TextBlock Text="X" Foreground="Black" FontWeight="Bold" FontSize="14" HorizontalAlignment="Center" VerticalAlignment="Center">
                                                            <TextBlock.Style>
                                                                <Style TargetType="TextBlock">
                                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding M240AdminBlocked}" Value="True">
                                                                            <Setter Property="Visibility" Value="Visible"/>
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </TextBlock.Style>
                                                        </TextBlock>
                                                    </Grid>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Header="Current .50" Width="Auto">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Grid>
                                                        <Border Background="{Binding FiftyCalColor}" BorderBrush="Gray" BorderThickness="1" Margin="1">
                                                            <TextBlock Text="{Binding FiftyCalQualified}" HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="Bold" Foreground="Black"/>
                                                        </Border>
                                                        <TextBlock Text="X" Foreground="Black" FontWeight="Bold" FontSize="14" HorizontalAlignment="Center" VerticalAlignment="Center">
                                                            <TextBlock.Style>
                                                                <Style TargetType="TextBlock">
                                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding FiftyCalAdminBlocked}" Value="True">
                                                                            <Setter Property="Visibility" Value="Visible"/>
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </TextBlock.Style>
                                                        </TextBlock>
                                                    </Grid>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Grid>
                        </GroupBox>
                        
                        <GroupBox Header="Select Instructors" Margin="0,0,0,20">
                            <Grid Margin="10">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="200"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <Label Grid.Row="0" Grid.Column="0" Content="Search by Last Name:" VerticalAlignment="Center" Margin="0,5"/>
                                <TextBox x:Name="SamiCswiSearchLastNameTextBox" Grid.Row="0" Grid.Column="1" Margin="10,5" Width="180" KeyDown="SamiCswiSearchLastNameTextBox_KeyDown"/>
                                <Button Grid.Row="0" Grid.Column="2" Content="Search" Click="SamiCswiSearchSailor_Click" Margin="10,5" Padding="15,5"/>
                                <TextBlock Grid.Row="0" Grid.Column="3" x:Name="SamiCswiSearchResultTextBlock" Margin="10,5" VerticalAlignment="Center" Foreground="Gray"/>
                                
                                <Label Grid.Row="1" Grid.Column="0" Content="Select Match:" VerticalAlignment="Center" Margin="0,5"/>
                                <ComboBox x:Name="SamiCswiSearchResultsComboBox" Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="3"
                                          Margin="10,5" DisplayMemberPath="DisplayName"
                                          SelectionChanged="SamiCswiSearchResultsComboBox_SelectionChanged" Visibility="Collapsed"/>

                                <TextBlock Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="4" x:Name="SamiCswiSelectedSailorTextBlock" 
                                           Margin="10,5,0,0" Foreground="Gray" Text="No sailor selected"/>
                                
                                <StackPanel Grid.Row="3" Grid.Column="2" Grid.ColumnSpan="2" Orientation="Horizontal" HorizontalAlignment="Left" Margin="0,10,0,0">
                                    <Button x:Name="AddSamiButton" Content="Add SAMI" Click="AddSamiButton_Click" Margin="0,0,10,0" Padding="20,5" IsEnabled="False"/>
                                    <Button x:Name="AddCswiButton" Content="Add CSWI" Click="AddCswiButton_Click" Padding="20,5" IsEnabled="False"/>
                                </StackPanel>
                            </Grid>
                        </GroupBox>

                        <GroupBox Header="Instructor Requirements" Margin="0,0,0,20">
                            <StackPanel Margin="10">
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                    <TextBlock Text="Role:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                    <ComboBox x:Name="SamiCswiRoleComboBox" Width="120" SelectionChanged="SamiCswiRoleComboBox_SelectionChanged">
                                        <ComboBoxItem Content="SAMI"/>
                                        <ComboBoxItem Content="CSWI"/>
                                    </ComboBox>
                                </StackPanel>

                                <GroupBox Header="Designation Letter" Margin="0,0,0,10">
                                    <Grid Margin="10">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="200"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>

                                        <Label Grid.Row="0" Grid.Column="0" Content="Designation Date:" Margin="0,5"/>
                                        <DatePicker x:Name="DesignationDatePicker" Grid.Row="0" Grid.Column="1" Margin="10,5"/>
                                        <Button Grid.Row="0" Grid.Column="2" Content="Upload Letter" Click="UploadDesignationLetter_Click" Margin="10,5" Padding="15,5"/>
                                        <TextBlock x:Name="DesignationStatusTextBlock" Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="4" Margin="0,5" Foreground="Gray"/>
                                    </Grid>
                                </GroupBox>

                                <GroupBox Header="Instructor Shoots">
                                    <Grid Margin="10">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="200"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="200"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>

                                        <Label Grid.Row="0" Grid.Column="0" Content="Qualification Date:" Margin="0,5"/>
                                        <DatePicker x:Name="InstructorQualDatePicker" Grid.Row="0" Grid.Column="1" Margin="10,5"/>
                                        <Label Grid.Row="0" Grid.Column="2" Content="Type:" Margin="10,5,5,5"/>
                                        <ComboBox x:Name="InstructorQualTypeComboBox" Grid.Row="0" Grid.Column="3" Margin="5,5,0,5" Width="120">
                                            <ComboBoxItem Content="3591/1"/>
                                            <ComboBoxItem Content="3591/2"/>
                                        </ComboBox>
                                        <Button Grid.Row="0" Grid.Column="4" Content="Upload Form" Click="UploadInstructorQualification_Click" Margin="10,5" Padding="15,5"/>

                                        <DataGrid x:Name="InstructorQualHistoryGrid" Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="6"
                                                  AutoGenerateColumns="False"
                                                  CanUserAddRows="False"
                                                  CanUserDeleteRows="False"
                                                  IsReadOnly="True"
                                                  HeadersVisibility="Column"
                                                  GridLinesVisibility="Horizontal"
                                                  RowHeight="25"
                                                  AlternatingRowBackground="LightGray"
                                                  Margin="0,10,0,0">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="Date" Binding="{Binding Date}" Width="120"/>
                                                <DataGridTextColumn Header="Type" Binding="{Binding Type}" Width="80"/>
                                                <DataGridTextColumn Header="File" Binding="{Binding FileName}" Width="*"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Grid>
                                </GroupBox>
                            </StackPanel>
                        </GroupBox>
                        
                        <TextBlock x:Name="SamiCswiStatusTextBlock" Foreground="Gray"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            
            
            <TabItem x:Name="DigitalEntryTab" Header="3591/1 Management">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="20" Orientation="Vertical" Width="Auto">
                        <GroupBox Header="Generate 3591/1" Margin="0,0,0,10">
                            <StackPanel>
                                <UniformGrid Columns="3" Rows="2" Margin="10">
                                    <StackPanel>
                                        <TextBlock Text="Ship or Station:"/>
                                        <ComboBox x:Name="DE_ShipStationBox" Width="180" SelectedIndex="0" SelectedValuePath="Content">
                                            <ComboBoxItem Content="USS Thomas Hudner"/>
                                            <ComboBoxItem Content="USS Donald Cook"/>
                                        </ComboBox>
                                    </StackPanel>
                                    <StackPanel>
                                        <TextBlock Text="Division or Activity:"/>
                                        <ComboBox x:Name="DE_DivisionActivityBox" Width="180" SelectedIndex="0" SelectedValuePath="Content">
                                            <ComboBoxItem Content=""/>
                                            <ComboBoxItem Content="Operations"/>
                                            <ComboBoxItem Content="Engineering"/>
                                            <ComboBoxItem Content="Combat Systems"/>
                                            <ComboBoxItem Content="Supply"/>
                                            <ComboBoxItem Content="Admin"/>
                                        </ComboBox>
                                    </StackPanel>
                                    <StackPanel>
                                        <TextBlock Text="Weapon(s) Fired:"/>
                                        <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                                            <CheckBox x:Name="DE_M9CheckBox" Content="M9" Margin="0,0,10,0"/>
                                            <CheckBox x:Name="DE_M16CheckBox" Content="M4/M16" Margin="0,0,10,0"/>
                                            <CheckBox x:Name="DE_M500CheckBox" Content="M500" Margin="0,0,5,0"/>
                                        </StackPanel>
                                    </StackPanel>
                                    <StackPanel>
                                        <TextBlock Text="Range Name / Station:"/>
                                        <ComboBox x:Name="DE_RangeNameLocationBox" Width="180" SelectedIndex="0" SelectedValuePath="Content">
                                            <ComboBoxItem Content="San Diego"/>
                                            <ComboBoxItem Content="Mayport"/>
                                        </ComboBox>
                                    </StackPanel>
                                    <StackPanel>
                                        <TextBlock Text="Date of Firing:"/>
                                        <DatePicker x:Name="DE_DateOfFiringPicker" Width="180"/>
                                    </StackPanel>
                                </UniformGrid>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    
                                    <!-- Sailor Selection Panel -->
                                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,5">
                                        <TextBlock Text="Quick Add Sailor:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                        <ComboBox x:Name="SailorSelectionComboBox" Width="200" 
                                                  DisplayMemberPath="DisplayName"
                                                  SelectionChanged="SailorSelectionComboBox_SelectionChanged"/>
                                        <Button Content="Add Selected Sailor" Margin="10,0,0,0" Padding="10,2" Click="AddSelectedSailor_Click"/>
                                        <Button Content="Refresh List" Margin="5,0,0,0" Padding="10,2" Click="RefreshSailorList_Click"/>
                                    </StackPanel>
                                    
                                    <DataGrid x:Name="DE_SailorGrid" Grid.Row="1" AutoGenerateColumns="False" CanUserAddRows="False" CanUserDeleteRows="True" Height="250">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Full Name" Binding="{Binding FullName}" Width="150" IsReadOnly="True"/>
                                            <DataGridTextColumn Header="DoD ID" Binding="{Binding DodId}" Width="90" IsReadOnly="True"/>
                                            <DataGridTextColumn Header="Rank/Rate" Binding="{Binding RankRate}" Width="80" IsReadOnly="True"/>
                                            <DataGridTextColumn Header="NHQC" Binding="{Binding NHQC}" Width="60"/>
                                            <DataGridTextColumn Header="RQC" Binding="{Binding RQC}" Width="60"/>
                                            <DataGridTextColumn Header="SPWC T1" Binding="{Binding SPWCT1}" Width="60"/>
                                            <DataGridTextColumn Header="SPWC T2" Binding="{Binding SPWCT2}" Width="60"/>
                                            <DataGridTextColumn Header="SPWC T3" Binding="{Binding SPWCT3}" Width="60"/>
                                            <DataGridTextColumn Header="HPWC T1" Binding="{Binding HPWCT1}" Width="60"/>
                                            <DataGridTextColumn Header="HPWC T2" Binding="{Binding HPWCT2}" Width="60"/>
                                            <DataGridTextColumn Header="HPWC T3" Binding="{Binding HPWCT3}" Width="60"/>
                                            <DataGridTextColumn Header="HLLC" Binding="{Binding HLLC}" Width="60"/>
                                            <DataGridTextColumn Header="RLLC" Binding="{Binding RLLC}" Width="60"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>
                                <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                                    <Button Content="Add Row" Width="80" Margin="0,0,10,0" Click="DE_AddRow_Click"/>
                                    <Button Content="Remove Row" Width="100" Click="DE_RemoveRow_Click"/>
                                </StackPanel>
                            </StackPanel>
                        </GroupBox>
                        <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                            <Button Content="Create 3591/1" Width="130" Margin="0,0,10,0" Click="DE_SaveForm_Click"/>
                            <Button Content="Clear" Width="100" Click="DE_ClearForm_Click"/>
                        </StackPanel>
                        
                        <GroupBox Header="Import Legacy 3591/1s" Margin="0,20,0,0">
                            <StackPanel Margin="10">
                                <TextBlock Text="Import historical 3591/1 qualification data for a faster first-time setup."
                                           Foreground="Gray" Margin="0,0,0,10"/>
                                <Grid Margin="0,0,0,10">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <Button Grid.Column="0" Content="Select 3591/1" Click="LegacySelectPdfButton_Click" Padding="15,5"/>
                                    <TextBox x:Name="LegacyPdfPathTextBox" Grid.Column="1" Margin="10,0" IsReadOnly="True" Width="220" HorizontalAlignment="Left"/>
                                    <Label Grid.Column="2" Content="Date:" Margin="10,0,5,0" VerticalAlignment="Center"/>
                                    <DatePicker x:Name="LegacyDatePicker" Grid.Column="3"/>
                                </Grid>
                                <Grid Margin="0,0,0,10">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="200"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Label Grid.Column="0" Content="Add Sailor:" VerticalAlignment="Center"/>
                                    <ComboBox x:Name="LegacySailorComboBox" Grid.Column="1" Margin="10,0" DisplayMemberPath="DisplayName"/>
                                    <Button Grid.Column="2" Content="Add Selected Sailor" Click="LegacyAddSailorButton_Click" Margin="10,0" Padding="15,5"/>
                                </Grid>
                                <DataGrid x:Name="LegacySailorsDataGrid"
                                          AutoGenerateColumns="False"
                                          CanUserAddRows="False"
                                          CanUserDeleteRows="False"
                                          IsReadOnly="False"
                                          HeadersVisibility="Column"
                                          GridLinesVisibility="Horizontal"
                                          RowHeight="25"
                                          AlternatingRowBackground="LightGray"
                                          Margin="0,0,0,10">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="200" IsReadOnly="True"/>
                                        <DataGridTextColumn Header="Rate" Binding="{Binding Rate}" Width="80" IsReadOnly="True"/>
                                        <DataGridTemplateColumn Header="M9 (Full)" Width="80">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <CheckBox IsChecked="{Binding M9, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                              HorizontalAlignment="Center"
                                                              VerticalAlignment="Center"
                                                              Focusable="False"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Header="M4/M16 (Full)" Width="100">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <CheckBox IsChecked="{Binding M4M16, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                              HorizontalAlignment="Center"
                                                              VerticalAlignment="Center"
                                                              Focusable="False"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Header="M500 (Full)" Width="90">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <CheckBox IsChecked="{Binding M500, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                              HorizontalAlignment="Center"
                                                              VerticalAlignment="Center"
                                                              Focusable="False"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Header="M9 (Sustainment)" Width="120">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <CheckBox IsChecked="{Binding M9Sustainment, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                              HorizontalAlignment="Center"
                                                              VerticalAlignment="Center"
                                                              Focusable="False"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Header="M4/M16 (Sustainment)" Width="140">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <CheckBox IsChecked="{Binding M4M16Sustainment, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                              HorizontalAlignment="Center"
                                                              VerticalAlignment="Center"
                                                              Focusable="False"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Header="M500 (Sustainment)" Width="130">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <CheckBox IsChecked="{Binding M500Sustainment, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                              HorizontalAlignment="Center"
                                                              VerticalAlignment="Center"
                                                              Focusable="False"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                    <Button Content="Import Legacy 3591/1s" Click="LegacyImportButton_Click" Padding="20,5"/>
                            </StackPanel>
                                <TextBlock x:Name="LegacyImportStatusTextBlock" Foreground="Gray" Margin="0,10,0,0"/>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            
            <TabItem x:Name="CrewServedTab" Header="3591/2 Management">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="20" Orientation="Vertical" Width="Auto">
                        <GroupBox Header="Generate 3591/2" Margin="0,0,0,10">
                            <StackPanel>
                                <UniformGrid Columns="3" Rows="2" Margin="10">
                                    <StackPanel>
                                        <TextBlock Text="Ship or Station:"/>
                                        <ComboBox x:Name="CSW_ShipStationBox" Width="180" SelectedIndex="0" SelectedValuePath="Content">
                                            <ComboBoxItem Content="USS Thomas Hudner"/>
                                            <ComboBoxItem Content="USS Donald Cook"/>
                                        </ComboBox>
                                    </StackPanel>
                                    <StackPanel>
                                        <TextBlock Text="Division or Activity:"/>
                                        <ComboBox x:Name="CSW_DivisionActivityBox" Width="180" SelectedIndex="0" SelectedValuePath="Content">
                                            <ComboBoxItem Content=""/>
                                            <ComboBoxItem Content="Operations"/>
                                            <ComboBoxItem Content="Engineering"/>
                                            <ComboBoxItem Content="Combat Systems"/>
                                            <ComboBoxItem Content="Supply"/>
                                            <ComboBoxItem Content="Admin"/>
                                        </ComboBox>
                                    </StackPanel>
                                    <StackPanel>
                                        <TextBlock Text="Weapon:"/>
                                        <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                                            <CheckBox x:Name="CSW_M240CheckBox" Content="M240" Margin="0,0,10,0"/>
                                            <CheckBox x:Name="CSW_M2CheckBox" Content="M2A1" Margin="0,0,5,0"/>
                                        </StackPanel>
                                    </StackPanel>
                                    <StackPanel>
                                        <TextBlock Text="Range Name / Station:"/>
                                        <ComboBox x:Name="CSW_RangeNameLocationBox" Width="180" SelectedIndex="0" SelectedValuePath="Content">
                                            <ComboBoxItem Content="San Diego"/>
                                            <ComboBoxItem Content="Mayport"/>
                                        </ComboBox>
                                    </StackPanel>
                                    <StackPanel>
                                        <TextBlock Text="Date of Firing:"/>
                                        <DatePicker x:Name="CSW_DateOfFiringPicker" Width="180"/>
                                    </StackPanel>
                                    <StackPanel>
                                        <TextBlock Text="CSWI:"/>
                                        <ComboBox x:Name="CSW_CSWIComboBox" Width="180" Margin="0,5,0,0"
                                                  DisplayMemberPath="DisplayName"/>
                                    </StackPanel>
                                </UniformGrid>
                                <StackPanel Margin="0,10,0,0">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    
                                    <!-- Sailor Selection Panel -->
                                    <Grid Grid.Row="0" Margin="0,0,0,8">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="Quick Add Sailor:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                            <ComboBox x:Name="CSW_SailorSelectionComboBox" Width="200" 
                                                      DisplayMemberPath="DisplayName"
                                                      SelectionChanged="CSW_SailorSelectionComboBox_SelectionChanged"/>
                                            <Button Content="Add Selected Sailor" Margin="10,0,0,0" Padding="10,2" Click="CSW_AddSelectedSailor_Click"/>
                                            <Button Content="Refresh List" Margin="5,0,0,0" Padding="10,2" Click="CSW_RefreshSailorList_Click"/>
                                        </StackPanel>
                                    </Grid>
                                    
                                    <StackPanel Grid.Row="1">
                                        <Grid Margin="0,0,0,4">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="140"/>
                                                <ColumnDefinition Width="80"/>
                                                <ColumnDefinition Width="55"/>
                                                <ColumnDefinition Width="55"/>
                                                <ColumnDefinition Width="55"/>
                                                <ColumnDefinition Width="55"/>
                                                <ColumnDefinition Width="55"/>
                                                <ColumnDefinition Width="55"/>
                                                <ColumnDefinition Width="55"/>
                                                <ColumnDefinition Width="55"/>
                                                <ColumnDefinition Width="55"/>
                                                <ColumnDefinition Width="55"/>
                                                <ColumnDefinition Width="55"/>
                                                <ColumnDefinition Width="55"/>
                                                <ColumnDefinition Width="55"/>
                                                <ColumnDefinition Width="55"/>
                                                <ColumnDefinition Width="55"/>
                                                <ColumnDefinition Width="55"/>
                                                <ColumnDefinition Width="55"/>
                                                <ColumnDefinition Width="55"/>
                                                <ColumnDefinition Width="55"/>
                                                <ColumnDefinition Width="55"/>
                                                <ColumnDefinition Width="55"/>
                                                <ColumnDefinition Width="55"/>
                                                <ColumnDefinition Width="55"/>
                                            </Grid.ColumnDefinitions>

                                            <Border Grid.Row="0" Grid.Column="2" Grid.ColumnSpan="11" Background="#FFEFEFEF" BorderBrush="#FFCCCCCC" BorderThickness="0,0,0,1">
                                                <TextBlock Text="Light-Medium Machine Gun (M240)" HorizontalAlignment="Center" FontWeight="Bold" Margin="0,4"/>
                                            </Border>
                                            <Border Grid.Row="0" Grid.Column="13" Grid.ColumnSpan="11" Background="#FFEFEFEF" BorderBrush="#FFCCCCCC" BorderThickness="0,0,0,1">
                                                <TextBlock Text="Heavy Machine Gun (.50)" HorizontalAlignment="Center" FontWeight="Bold" Margin="0,4"/>
                                            </Border>
                                            <Border Grid.Row="0" Grid.RowSpan="2" Grid.Column="13" BorderBrush="Black" BorderThickness="2,0,0,0"/>
                                            <Border Grid.Row="1" Grid.Column="2" BorderBrush="Black" BorderThickness="2,0,0,0"/>
                                            <Border Grid.Row="1" Grid.Column="8" BorderBrush="Black" BorderThickness="2,0,0,0"/>
                                            <Border Grid.Row="1" Grid.Column="19" BorderBrush="Black" BorderThickness="2,0,0,0"/>

                                            <Border Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" Background="#FFF7F7F7" BorderBrush="#FFDDDDDD" BorderThickness="0,0,0,1">
                                                <TextBlock Text="Sailor" HorizontalAlignment="Center" FontWeight="Bold" Margin="0,3"/>
                                            </Border>
                                            <Border Grid.Row="1" Grid.Column="2" Grid.ColumnSpan="6" Background="#FFF7F7F7" BorderBrush="#FFDDDDDD" BorderThickness="0,0,0,1">
                                                <TextBlock Text="Free Gun" HorizontalAlignment="Center" Margin="0,3"/>
                                            </Border>
                                            <Border Grid.Row="1" Grid.Column="8" Grid.ColumnSpan="5" Background="#FFF7F7F7" BorderBrush="#FFDDDDDD" BorderThickness="0,0,0,1">
                                                <TextBlock Text="T&amp;E" HorizontalAlignment="Center" Margin="0,3"/>
                                            </Border>
                                            <Border Grid.Row="1" Grid.Column="13" Grid.ColumnSpan="6" Background="#FFF7F7F7" BorderBrush="#FFDDDDDD" BorderThickness="0,0,0,1">
                                                <TextBlock Text="Free Gun" HorizontalAlignment="Center" Margin="0,3"/>
                                            </Border>
                                            <Border Grid.Row="1" Grid.Column="19" Grid.ColumnSpan="5" Background="#FFF7F7F7" BorderBrush="#FFDDDDDD" BorderThickness="0,0,0,1">
                                                <TextBlock Text="T&amp;E" HorizontalAlignment="Center" Margin="0,3"/>
                                            </Border>
                                        </Grid>

                                        <DataGrid x:Name="CSW_EntryGrid" AutoGenerateColumns="False" CanUserAddRows="False" CanUserDeleteRows="True" Height="300">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="Name" Binding="{Binding GunnerName}" Width="140" IsReadOnly="True"/>
                                                <DataGridTextColumn Header="Rank" Binding="{Binding GunnerRankRate}" Width="80" IsReadOnly="True">
                                                    <DataGridTextColumn.CellStyle>
                                                        <Style TargetType="DataGridCell">
                                                            <Setter Property="BorderThickness" Value="0,0,2,0"/>
                                                            <Setter Property="BorderBrush" Value="Black"/>
                                                        </Style>
                                                    </DataGridTextColumn.CellStyle>
                                                    <DataGridTextColumn.HeaderStyle>
                                                        <Style TargetType="DataGridColumnHeader">
                                                            <Setter Property="BorderThickness" Value="0,0,2,0"/>
                                                            <Setter Property="BorderBrush" Value="Black"/>
                                                        </Style>
                                                    </DataGridTextColumn.HeaderStyle>
                                                </DataGridTextColumn>

                                                <DataGridTextColumn Header="P1" Binding="{Binding LightFreeP1}" Width="55"/>
                                                <DataGridTextColumn Header="P2" Binding="{Binding LightFreeP2}" Width="55"/>
                                                <DataGridTextColumn Header="P3" Binding="{Binding LightFreeP3}" Width="55"/>
                                                <DataGridTextColumn Header="P4" Binding="{Binding LightFreeP4}" Width="55"/>
                                                <DataGridTextColumn Header="P5" Binding="{Binding LightFreeP5}" Width="55"/>
                                                <DataGridTextColumn Header="P6" Binding="{Binding LightFreeP6}" Width="55">
                                                    <DataGridTextColumn.CellStyle>
                                                        <Style TargetType="DataGridCell">
                                                            <Setter Property="BorderThickness" Value="0,0,2,0"/>
                                                            <Setter Property="BorderBrush" Value="Black"/>
                                                        </Style>
                                                    </DataGridTextColumn.CellStyle>
                                                    <DataGridTextColumn.HeaderStyle>
                                                        <Style TargetType="DataGridColumnHeader">
                                                            <Setter Property="BorderThickness" Value="0,0,2,0"/>
                                                            <Setter Property="BorderBrush" Value="Black"/>
                                                        </Style>
                                                    </DataGridTextColumn.HeaderStyle>
                                                </DataGridTextColumn>
                                                <DataGridTextColumn Header="P1" Binding="{Binding LightTeP1}" Width="55"/>
                                                <DataGridTextColumn Header="P2" Binding="{Binding LightTeP2}" Width="55"/>
                                                <DataGridTextColumn Header="P3" Binding="{Binding LightTeP3}" Width="55"/>
                                                <DataGridTextColumn Header="P4" Binding="{Binding LightTeP4}" Width="55"/>
                                                <DataGridTextColumn Header="P5" Binding="{Binding LightTeP5}" Width="55">
                                                    <DataGridTextColumn.CellStyle>
                                                        <Style TargetType="DataGridCell">
                                                            <Setter Property="BorderThickness" Value="0,0,2,0"/>
                                                            <Setter Property="BorderBrush" Value="Black"/>
                                                        </Style>
                                                    </DataGridTextColumn.CellStyle>
                                                    <DataGridTextColumn.HeaderStyle>
                                                        <Style TargetType="DataGridColumnHeader">
                                                            <Setter Property="BorderThickness" Value="0,0,2,0"/>
                                                            <Setter Property="BorderBrush" Value="Black"/>
                                                        </Style>
                                                    </DataGridTextColumn.HeaderStyle>
                                                </DataGridTextColumn>

                                                <DataGridTextColumn Header="P1" Binding="{Binding HeavyFreeP1}" Width="55"/>
                                                <DataGridTextColumn Header="P2" Binding="{Binding HeavyFreeP2}" Width="55"/>
                                                <DataGridTextColumn Header="P3" Binding="{Binding HeavyFreeP3}" Width="55"/>
                                                <DataGridTextColumn Header="P4" Binding="{Binding HeavyFreeP4}" Width="55"/>
                                                <DataGridTextColumn Header="P5" Binding="{Binding HeavyFreeP5}" Width="55"/>
                                                <DataGridTextColumn Header="P6" Binding="{Binding HeavyFreeP6}" Width="55">
                                                    <DataGridTextColumn.CellStyle>
                                                        <Style TargetType="DataGridCell">
                                                            <Setter Property="BorderThickness" Value="0,0,2,0"/>
                                                            <Setter Property="BorderBrush" Value="Black"/>
                                                        </Style>
                                                    </DataGridTextColumn.CellStyle>
                                                    <DataGridTextColumn.HeaderStyle>
                                                        <Style TargetType="DataGridColumnHeader">
                                                            <Setter Property="BorderThickness" Value="0,0,2,0"/>
                                                            <Setter Property="BorderBrush" Value="Black"/>
                                                        </Style>
                                                    </DataGridTextColumn.HeaderStyle>
                                                </DataGridTextColumn>
                                                <DataGridTextColumn Header="P1" Binding="{Binding HeavyTeP1}" Width="55"/>
                                                <DataGridTextColumn Header="P2" Binding="{Binding HeavyTeP2}" Width="55"/>
                                                <DataGridTextColumn Header="P3" Binding="{Binding HeavyTeP3}" Width="55"/>
                                                <DataGridTextColumn Header="P4" Binding="{Binding HeavyTeP4}" Width="55"/>
                                                <DataGridTextColumn Header="P5" Binding="{Binding HeavyTeP5}" Width="55"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </StackPanel>
                                </Grid>
                                <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                                    <Button Content="Add Row" Width="80" Margin="0,0,10,0" Click="CSW_AddRow_Click"/>
                                    <Button Content="Remove Row" Width="100" Click="CSW_RemoveRow_Click"/>
                                </StackPanel>
                                </StackPanel>
                            </StackPanel>
                        </GroupBox>
                        <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                            <Button Content="Create 3591/2" Width="130" Margin="0,0,10,0" Click="CSW_SaveForm_Click"/>
                            <Button Content="Clear" Width="100" Click="CSW_ClearForm_Click"/>
                        </StackPanel>
                        <GroupBox Header="Upload Legacy 3591/2" Margin="0,20,0,0">
                            <StackPanel Margin="10">
                                <TextBlock Text="Import historical 3591/2 qualification data for a faster first-time setup."
                                           Foreground="Gray" Margin="0,0,0,10"/>
                                <Grid Margin="0,0,0,10">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <Button Grid.Column="0" Content="Select 3591/2" Click="LegacyCswSelectPdfButton_Click" Padding="15,5"/>
                                    <TextBox x:Name="LegacyCswPdfPathTextBox" Grid.Column="1" Margin="10,0" IsReadOnly="True" Width="220" HorizontalAlignment="Left"/>
                                    <Label Grid.Column="2" Content="Date:" Margin="10,0,5,0" VerticalAlignment="Center"/>
                                    <DatePicker x:Name="LegacyCswDatePicker" Grid.Column="3"/>
                                </Grid>
                                <Grid Margin="0,0,0,10">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="200"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Label Grid.Column="0" Content="Add Sailor:" VerticalAlignment="Center"/>
                                    <ComboBox x:Name="LegacyCswSailorComboBox" Grid.Column="1" Margin="10,0" DisplayMemberPath="DisplayName"/>
                                    <Button Grid.Column="2" Content="Add Selected Sailor" Click="LegacyCswAddSailorButton_Click" Margin="10,0" Padding="15,5"/>
                                </Grid>
                                <DataGrid x:Name="LegacyCswSailorsDataGrid"
                                          AutoGenerateColumns="False"
                                          CanUserAddRows="False"
                                          CanUserDeleteRows="False"
                                          IsReadOnly="False"
                                          HeadersVisibility="Column"
                                          GridLinesVisibility="Horizontal"
                                          RowHeight="25"
                                          AlternatingRowBackground="LightGray"
                                          Margin="0,0,0,10">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="200" IsReadOnly="True"/>
                                        <DataGridTextColumn Header="Rate" Binding="{Binding Rate}" Width="80" IsReadOnly="True"/>
                                        <DataGridTemplateColumn Header="M240 (Full)" Width="100">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <CheckBox IsChecked="{Binding M240, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                              HorizontalAlignment="Center"
                                                              VerticalAlignment="Center"
                                                              Focusable="False"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Header="M2A1 (Full)" Width="100">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <CheckBox IsChecked="{Binding M2A1, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                              HorizontalAlignment="Center"
                                                              VerticalAlignment="Center"
                                                              Focusable="False"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Header="M240 (Sustainment)" Width="140">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <CheckBox IsChecked="{Binding M240Sustainment, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                              HorizontalAlignment="Center"
                                                              VerticalAlignment="Center"
                                                              Focusable="False"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Header="M2A1 (Sustainment)" Width="140">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <CheckBox IsChecked="{Binding M2A1Sustainment, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                              HorizontalAlignment="Center"
                                                              VerticalAlignment="Center"
                                                              Focusable="False"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                    <Button Content="Import Legacy 3591/2s" Click="LegacyCswImportButton_Click" Padding="20,5"/>
                            </StackPanel>
                                <TextBlock x:Name="LegacyCswImportStatusTextBlock" Foreground="Gray" Margin="0,10,0,0"/>
                            </StackPanel>
                        </GroupBox>
                        
                        
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <TabItem x:Name="SupportTab" Header="Support">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="20">
                        <TextBlock Text="Support &amp; Development Tools" FontSize="18" FontWeight="Bold" Margin="0,0,0,20"/>
                        
                        <!-- Test Data Management -->
                        <GroupBox Header="Test Data Management" Margin="0,0,0,20">
                            <StackPanel Margin="10">
                                <TextBlock Text="Development and testing tools for managing sample data." Margin="0,0,0,10"/>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                    <Button x:Name="AddTestDataButton" Content="Add Test Data (50 Sailors)" Click="AddTestDataButton_Click" Margin="0,0,10,0" Padding="20,5"/>
                                    <Button x:Name="ClearDatabaseButton" Content="Clear Database" Click="ClearDatabaseButton_Click" Padding="20,5"/>
                                </StackPanel>
                                <TextBlock x:Name="TestDataStatusTextBlock" Text="" Margin="0,0,0,10"/>
                            </StackPanel>
                        </GroupBox>
                        
                        <!-- DEVELOPMENT ONLY - Score Range Reference -->
                        <Border Background="#FFF3CD" BorderBrush="#FFEAA7" BorderThickness="1" CornerRadius="4" Margin="0,0,0,20" Padding="10">
                            <StackPanel>
                                <TextBlock Text=" DEVELOPMENT ONLY - Valid Score Ranges" FontWeight="Bold" Foreground="#856404" Margin="0,0,0,5"/>
                                <TextBlock Text="Full Qualification:" FontWeight="Bold" FontSize="12" Foreground="#856404" Margin="0,5,0,0"/>
                                <TextBlock Text="M9 CAT II: NHQC (180-240), HLLC (12-18), HPWC Total (12-18)" FontSize="11" Foreground="#856404"/>
                                <TextBlock Text="M9 CAT I: HQC (180-240)" FontSize="11" Foreground="#856404"/>
                                <TextBlock Text="M4/M16 CAT II: RQC (140-200), RLC (14-20)" FontSize="11" Foreground="#856404"/>
                                <TextBlock Text="M500 CAT II: SPWC Total (90-162)" FontSize="11" Foreground="#856404"/>
                                <TextBlock Text="M240/M2: COF (100)" FontSize="11" Foreground="#856404"/>
                                <TextBlock Text=""/>
                                <TextBlock Text="Sustainment Qualification:" FontWeight="Bold" FontSize="12" Foreground="#856404" Margin="0,5,0,0"/>
                                <TextBlock Text="M9/M18: Navy Handgun Qualification Course (NHQC)  Passing Score: 180" FontSize="11" Foreground="#856404"/>
                                <TextBlock Text="M4/M16: Rifle Qualification Course (RQC)  Passing Score: 30 hits" FontSize="11" Foreground="#856404"/>
                                <TextBlock Text="M500: Shotgun Practical Weapons Course (SPWC)  Passing Score: 90" FontSize="11" Foreground="#856404"/>
                                <TextBlock Text="M240/M2: Course of Fire (COF)  Passing Score: 100" FontSize="11" Foreground="#856404"/>
                                <TextBlock Text=""/>
                                <TextBlock Text="Crew Served Weapons:" FontWeight="Bold" FontSize="12" Foreground="#856404" Margin="0,5,0,0"/>
                                <TextBlock Text="M240/M2A1: COF (100) - Passing Score: 100" FontSize="11" Foreground="#856404"/>
                                <TextBlock Text="Validity: 1 year from date of qualification" FontSize="11" Foreground="#856404"/>
                                <TextBlock Text="Requires CSWI signature (Crew Served Weapons Instructor with valid 3591/2)" FontSize="11" Foreground="#856404"/>
                                <TextBlock Text=" This banner will be removed before production" FontSize="10" FontStyle="Italic" Foreground="#856404" Margin="0,5,0,0"/>
                            </StackPanel>
                        </Border>
                        
                        <!-- Performance Metrics -->
                        <GroupBox Header="System Performance Metrics" Margin="0,0,0,20">
                            <StackPanel Margin="10">
                                <!-- Database Performance -->
                                <Expander Header="Database Performance" Margin="0,0,0,10">
                                    <Grid Margin="10">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <Label Grid.Row="0" Grid.Column="0" Content="Average Load Time:" FontWeight="Bold"/>
                                        <TextBlock x:Name="AvgLoadTimeText" Grid.Row="0" Grid.Column="1" Text="0 ms" Margin="10,0"/>
                                        <Label Grid.Row="0" Grid.Column="2" Content="Load Count:" FontWeight="Bold"/>
                                        <TextBlock x:Name="LoadCountText" Grid.Row="0" Grid.Column="3" Text="0" Margin="10,0"/>
                                        
                                        <Label Grid.Row="1" Grid.Column="0" Content="Average Filter Time:" FontWeight="Bold"/>
                                        <TextBlock x:Name="AvgFilterTimeText" Grid.Row="1" Grid.Column="1" Text="0 ms" Margin="10,0"/>
                                        <Label Grid.Row="1" Grid.Column="2" Content="Filter Count:" FontWeight="Bold"/>
                                        <TextBlock x:Name="FilterCountText" Grid.Row="1" Grid.Column="3" Text="0" Margin="10,0"/>
                                        
                                        <Label Grid.Row="2" Grid.Column="0" Content="Total Personnel:" FontWeight="Bold"/>
                                        <TextBlock x:Name="TotalPersonnelText" Grid.Row="2" Grid.Column="1" Text="0" Margin="10,0"/>
                                        <Label Grid.Row="2" Grid.Column="2" Content="Total Qualifications:" FontWeight="Bold"/>
                                        <TextBlock x:Name="TotalQualificationsText" Grid.Row="2" Grid.Column="3" Text="0" Margin="10,0"/>
                                    </Grid>
                                </Expander>
                                
                                <!-- Cache Performance -->
                                <Expander Header="Cache Performance" Margin="0,0,0,10">
                                    <Grid Margin="10">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <Label Grid.Row="0" Grid.Column="0" Content="Cache Size:" FontWeight="Bold"/>
                                        <TextBlock x:Name="CacheSizeText" Grid.Row="0" Grid.Column="1" Text="0 entries" Margin="10,0"/>
                                        <Label Grid.Row="0" Grid.Column="2" Content="Expired Entries:" FontWeight="Bold"/>
                                        <TextBlock x:Name="ExpiredEntriesText" Grid.Row="0" Grid.Column="3" Text="0" Margin="10,0"/>
                                        
                                        <Label Grid.Row="1" Grid.Column="0" Content="Cache Hit Rate:" FontWeight="Bold"/>
                                        <TextBlock x:Name="CacheHitRateText" Grid.Row="1" Grid.Column="1" Text="0%" Margin="10,0"/>
                                        <Button Grid.Row="1" Grid.Column="2" Content="Clear Cache" Click="ClearCache_Click" Margin="10,0" Padding="10,5"/>
                                    </Grid>
                                </Expander>
                                
                                <!-- System Status -->
                                <Expander Header="System Status" Margin="0,0,0,10">
                                    <Grid Margin="10">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <Label Grid.Row="0" Grid.Column="0" Content="Database Status:" FontWeight="Bold"/>
                                        <TextBlock x:Name="DatabaseStatusText" Grid.Row="0" Grid.Column="1" Text="Connected" Margin="10,0" Foreground="Green"/>
                                        <Label Grid.Row="0" Grid.Column="2" Content="Last Backup:" FontWeight="Bold"/>
                                        <TextBlock x:Name="LastBackupText" Grid.Row="0" Grid.Column="3" Text="Never" Margin="10,0"/>
                                        
                                        <Label Grid.Row="1" Grid.Column="0" Content="System Uptime:" FontWeight="Bold"/>
                                        <TextBlock x:Name="SystemUptimeText" Grid.Row="1" Grid.Column="1" Text="0 days, 0 hours" Margin="10,0"/>
                                        <Label Grid.Row="1" Grid.Column="2" Content="Memory Usage:" FontWeight="Bold"/>
                                        <TextBlock x:Name="MemoryUsageText" Grid.Row="1" Grid.Column="3" Text="0 MB" Margin="10,0"/>
                                    </Grid>
                                </Expander>
                                
                                <!-- Action Buttons -->
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,10,0,0">
                                    <Button Content="Export Performance Report" Click="ExportPerformanceReport_Click" Margin="5" Padding="15,5"/>
                                    <Button Content="Reset Performance Counters" Click="ResetPerformanceCounters_Click" Margin="5" Padding="15,5"/>
                                </StackPanel>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

        </TabControl>
    </Grid>
</Window> 